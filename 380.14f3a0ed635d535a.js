"use strict";(self.webpackChunkalojamiento_frontend=self.webpackChunkalojamiento_frontend||[]).push([[380],{6913:(O,T,r)=>{r.d(T,{A:()=>S});var i=r(5551),f=r(8463),g=r(1571),I=r(4833);let S=(()=>{class l extends f.O{constructor(a){super(),this.accomodationRepo=a,this.router=i.J.Alojamientos}getAll(a){return this.accomodationRepo.getAll(this.router,a)}getById(a){return this.accomodationRepo.getById(this.router,a)}create(a){return this.accomodationRepo.create(this.router,a)}update(a,m){return this.accomodationRepo.updateTypeServices(this.router,a,m)}remove(a){return this.accomodationRepo.remove(this.router,a)}}return l.\u0275fac=function(a){return new(a||l)(g.LFG(I._))},l.\u0275prov=g.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},6891:(O,T,r)=>{r.d(T,{s:()=>S});var i=r(5551),f=r(8463),g=r(1571),I=r(4833);let S=(()=>{class l extends f.O{constructor(a){super(),this.productsRepo=a,this.router=i.J.Productos}getAll(a){return this.productsRepo.getAll(this.router,a)}getById(a){return this.productsRepo.getById(this.router,a)}create(a){return this.productsRepo.create(this.router,a)}update(a,m){return this.productsRepo.updateTypeServices(this.router,a,m)}remove(a){return this.productsRepo.remove(this.router,a)}}return l.\u0275fac=function(a){return new(a||l)(g.LFG(I._))},l.\u0275prov=g.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},4380:(O,T,r)=>{r.r(T),r.d(T,{ProductShoppingModule:()=>F});var i=r(6895),f=r(6646),g=r(4385),I=r(1135),S=r(2722),l=r(168),y=r(8268);const a={id:{title:"ID",sort:!1,width:"10%"},alojamientos:{title:"Nombre de Alojamiento",sort:!1,valuePrepareFunction:s=>s?.nombre,filterFunction:(s,p)=>"string"!=typeof p||s.nombre?.toUpperCase()>=p.toUpperCase()||""===p},productos:{title:"Nombre de Productos",sort:!1,valuePrepareFunction:s=>s?.nombre,filterFunction:(s,p)=>"string"!=typeof p||s.nombre?.toUpperCase()>=p.toUpperCase()||""===p}};var m=r(4006),C=r(4553),e=r(1571),A=r(388),R=r(6891),_=r(5551),M=r(8463),E=r(4833);let x=(()=>{class s extends M.O{constructor(o){super(),this.productShoppingRepo=o,this.router=_.J.ProductoCompras}getAll(o){return this.productShoppingRepo.getAll(this.router,o)}getById(o){return this.productShoppingRepo.getById(this.router,o)}create(o){return this.productShoppingRepo.create(this.router,o)}update(o,n){return this.productShoppingRepo.updateTypeServices(this.router,o,n)}remove(o){return this.productShoppingRepo.remove(this.router,o)}}return s.\u0275fac=function(o){return new(o||s)(e.LFG(E._))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var D=r(6913),u=r(312),b=r(4576),t=r(7597),c=r(7209);let v=(()=>{class s extends y.nh{constructor(o,n,d,h,P,Q){super(),this.modalRef=o,this.fb=n,this.productsService=d,this.datePipe=h,this.productShoppingService=P,this.accomodationService=Q,this.form=new m.cw({}),this.title="PRODUCTO COMPRA",this.status="Nuevo",this.edit=!1,this.maxDate=new Date,this.accomodations=new C.b,this.products=new C.b}ngOnInit(){this.prepareForm()}prepareForm(){this.form=this.fb.group({productoId:[null,[m.kI.required]],alojamientoId:[null,[m.kI.required]]}),null!=this.productShopping&&(this.edit=!0,this.form.patchValue(this.productShopping)),setTimeout(()=>{this.getAccomodation(new l.NV),this.getProducts(new l.NV)},1e3)}confirm(){this.edit?this.update():this.create()}create(){this.loading=!0;let o={productoId:Number(this.form.controls.productoId.getRawValue()),alojamientoId:Number(this.form.controls.alojamientoId.getRawValue())};this.productShoppingService.create(o).subscribe({next:n=>{this.handleSuccess(),this.loading=!1},error:n=>{this.loading=!1}})}handleSuccess(){this.alert("success",this.title,(this.edit?"Actualizada":"Guardada")+" Correctamente"),this.loading=!1,this.modalRef.content.callback(!0),this.modalRef.hide()}update(){if(this.productShopping){this.loading=!0;let o={productoId:Number(this.form.controls.productoId.getRawValue()),alojamientoId:Number(this.form.controls.alojamientoId.getRawValue())};this.productShoppingService.update(this.productShopping.id,o).subscribe({next:n=>{this.loading=!1,this.handleSuccess()},error:n=>{this.loading=!1}})}}close(){this.modalRef.hide()}getAccomodation(o){o.text&&(o["filter.nombre"]=`$ilike:${o.text}`),this.accomodationService.getAll(o).subscribe({next:n=>{this.accomodations=new C.b(n.data,n.count)},error:n=>{this.accomodations=new C.b,this.loading=!1}})}onChangeAccomodation(o){console.log(o)}validateDate(o){o&&(this.editDate=o)}getProducts(o){o.text&&(o["filter.nombre"]=`$ilike:${o.text}`),this.productsService.getAll(o).subscribe({next:n=>{this.products=new C.b(n.data,n.count)},error:n=>{this.products=new C.b,this.loading=!1}})}onChangeProducts(o){console.log(o)}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(A.UZ),e.Y36(m.qu),e.Y36(R.s),e.Y36(i.uU),e.Y36(x),e.Y36(D.A))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-productShopping-detail"]],features:[e.qOj],decls:20,vars:13,consts:[["header",""],[1,"modal-title"],["body",""],[1,"form-material",3,"formGroup"],[1,"row"],[1,"col-md-6"],[3,"control"],["control","alojamientoId","bindLabel","nombre","label","Nombre del Alojamiento","value","id",3,"form","data","readonly","fetchItems","change"],["control","productoId","bindLabel","nombre","label","Nombre del Producto","value","id",3,"form","data","readonly","fetchItems","change"],["footer",""],[1,"d-flex","justify-content-center"],[1,"m-3"],[3,"type","disabled","confirm"],["type","button",1,"btn","btn-danger","active",3,"click"]],template:function(o,n){1&o&&(e.TgZ(0,"app-modal")(1,"div",0)(2,"h5",1),e._uU(3),e.qZA()(),e.TgZ(4,"div",2)(5,"form",3)(6,"div",4)(7,"div",5)(8,"form-field",6)(9,"ngx-select",7),e.NdJ("fetchItems",function(h){return n.getAccomodation(h)})("change",function(h){return n.onChangeAccomodation(h)}),e.qZA()()(),e.TgZ(10,"div",5)(11,"form-field",6)(12,"ngx-select",8),e.NdJ("fetchItems",function(h){return n.getProducts(h)})("change",function(h){return n.onChangeProducts(h)}),e.qZA()()()()()(),e.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"confirm-button",12),e.NdJ("confirm",function(){return n.confirm()}),e.qZA()(),e.TgZ(17,"div",11)(18,"button",13),e.NdJ("click",function(){return n.close()}),e._uU(19," Cancelar "),e.qZA()()()()()),2&o&&(e.xp6(3),e.AsE("",n.edit?"Editar":"Nuevo"," ",n.title,""),e.xp6(2),e.Q6J("formGroup",n.form),e.xp6(3),e.Q6J("control",n.form.get("alojamientoId")),e.xp6(1),e.Q6J("form",n.form)("data",n.accomodations)("readonly",!1),e.xp6(2),e.Q6J("control",n.form.get("productoId")),e.xp6(1),e.Q6J("form",n.form)("data",n.products)("readonly",!1),e.xp6(4),e.Q6J("type","button")("disabled",n.form.invalid))},dependencies:[m._Y,m.JL,u.z,b.h,t.f,m.sg,c.H]}),s})();var L=r(9219),N=r(2243),U=r(4554);const Z=[{path:"",component:(()=>{class s extends y.nh{constructor(o,n){super(),this.modalService=o,this.productShoppingService=n,this.data=new g.nC,this.params=new I.X(new l.NV),this.data1=[],this.columnFilters=[],this.totalItems=0,this.settings={...this.settings,hideSubHeader:!1,actions:{columnTitle:"Acciones",edit:!0,delete:!0,add:!1,position:"right"},columns:{...a}}}ngOnInit(){this.data.onChanged().pipe((0,S.R)(this.$unSubscribe)).subscribe(o=>{"filter"===o.action&&(o.filter.filters.map(d=>{let h="",P=l.ay.ILIKE;switch(h=`filter.${d.field}`,d.field){case"id":P=l.ay.EQ;break;case"productos":case"alojamientos":P=l.ay.ILIKE,h=`filter.${d.field}.nombre`;break;default:P=l.ay.ILIKE}""!==d.search?this.columnFilters[h]=`${P}:${d.search}`:delete this.columnFilters[h]}),this.params=this.pageFilter(this.params),this.getAllShopping())}),this.params.pipe((0,S.R)(this.$unSubscribe)).subscribe(()=>this.getAllShopping())}getAllShopping(){this.loading=!0;let o={...this.params.getValue(),...this.columnFilters};this.productShoppingService.getAll(o).subscribe({next:n=>{console.log(n),this.data.load(n.data),this.data.refresh(),this.totalItems=n.count,this.loading=!1},error:n=>{this.loading=!1,this.data.load([])}})}edit(o){this.openModal(o)}openModal(o){this.modalService.show(v,{initialState:{productShopping:o,callback:d=>{d&&this.getAllShopping()}},class:"modal-lg modal-dialog-centered",ignoreBackdropClick:!0})}showDeleteAlert(o){this.alertQuestion("warning","Eliminar","\xbfDesea eliminar este registro?").then(n=>{n.isConfirmed&&this.delete(o.id)})}delete(o){this.productShoppingService.remove(o).subscribe({next:()=>{this.alert("success","PRODUCTO COMPRA","Borrado Correctamente"),this.params.pipe((0,S.R)(this.$unSubscribe)).subscribe(()=>this.getAllShopping())},error:n=>{this.alert("error","No se logro Eliminar","Existe una relacion")}})}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(A.tT),e.Y36(x))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-productShopping-list"]],features:[e.qOj],decls:19,vars:9,consts:[[3,"header"],["header","",1,"ch-content"],[1,"title"],["body",""],[1,"row"],[1,"col-md-8","mb-3"],[1,"col-md-4","text-end","d-flex","flex-row-reverse","mb-3"],[1,"mr-3"],["type","button","tooltip","Nuevo","containerclass","tooltip-style",1,"btn","btn-info","btn-sm","active","d-flex","justify-content-center","align-items-center","ml-3",3,"click"],[1,"bx","bx-plus","bx-sm","ml-2"],[3,"settings","leftList","settingsChange"],[1,"col-md-12"],[1,"table-responsive"],[3,"settings","source","edit","delete"],[3,"params","totalItems"]],template:function(o,n){1&o&&(e.TgZ(0,"app-card",0)(1,"div",1)(2,"h5",2),e._uU(3,"PRODUCTO COMPRA"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4),e._UZ(6,"div",5),e.TgZ(7,"div",6)(8,"div",7)(9,"button",8),e.NdJ("click",function(){return n.openModal()}),e._uU(10," Nuevo "),e._UZ(11,"i",9),e.qZA()(),e.TgZ(12,"app-columns-select",10),e.NdJ("settingsChange",function(h){return n.settings=h}),e.qZA()()(),e.TgZ(13,"div",4)(14,"div",11)(15,"div")(16,"div",12)(17,"ng2-smart-table",13),e.NdJ("edit",function(h){return n.edit(h.data)})("delete",function(h){return n.showDeleteAlert(h.data)}),e.qZA()(),e._UZ(18,"app-pagination",14),e.qZA()()()()()),2&o&&(e.Q6J("header",!0),e.xp6(12),e.Q6J("settings",n.settings)("leftList",!0),e.xp6(3),e.Tol(n.loading?"table-loading":""),e.xp6(2),e.Q6J("settings",n.settings)("source",n.data),e.xp6(1),e.Q6J("params",n.params)("totalItems",n.totalItems))},dependencies:[L.A,N.L,g.T5,U.Q]}),s})()}];let B=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[f.Bz.forChild(Z),f.Bz]}),s})();var J=r(8909);let F=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[i.ez,B,J.m8,A.zk.forChild()]}),s})()},7209:(O,T,r)=>{r.d(T,{H:()=>D});var i=r(1571),f=r(4006),g=r(8796),I=r(7579),S=r(2722),l=r(8372),y=r(1884),a=r(3900),m=r(9646),e=r(168),A=r(4553),R=r(6895);function _(u,b){if(1&u&&(i.TgZ(0,"div",10),i._uU(1),i.qZA()),2&u){const t=b.item,c=i.oxw(3);i.Q6J("title",t[c.bindLabel]),i.xp6(1),i.Oqu(t[c.bindLabel])}}function M(u,b){1&u&&i.YNc(0,_,2,2,"ng-template",9)}function E(u,b){1&u&&(i.TgZ(0,"span"),i._uU(1,"*"),i.qZA()),2&u&&i.Udp("color","#9D2449")}function x(u,b){if(1&u){const t=i.EpF();i.ynx(0,1),i.TgZ(1,"div",2)(2,"ng-select",3,4),i.NdJ("scrollToEnd",function(){i.CHM(t);const v=i.MAs(3),L=i.oxw();return i.KtG(L.fetchMore(v.searchTerm))})("change",function(v){i.CHM(t);const L=i.oxw();return i.KtG(L.onChange(v))})("clear",function(){i.CHM(t);const v=i.oxw();return i.KtG(v.clear.emit())}),i.YNc(4,M,1,0,null,5),i.qZA(),i._UZ(5,"span",6),i.TgZ(6,"label",7),i._uU(7),i.YNc(8,E,2,2,"span",8),i.qZA()(),i.BQk()}if(2&u){const t=i.oxw();i.Q6J("formGroup",t.form),i.xp6(2),i.Q6J("clearable",t.clearable)("items",t.buffer)("bindLabel",t.bindLabel)("hideSelected",!0)("closeOnSelect",t.closeOnSelect)("maxSelectedItems",t.maxSelectedItems)("multiple",t.multiple)("bindValue",t.value)("minTermLength",0)("loading",t.loading)("addTag",t.addTag)("typeToSearchText",t.typeToSearchText)("typeahead",t.input$)("virtualScroll",!0)("formControlName",t.control)("searchable",t.searchable)("placeholder",t.placeholder)("readonly",t.readonly)("inputAttrs",t.inputAttrs)("title",t.title),i.uIk("class",t.className+" form-control"),i.xp6(2),i.Q6J("ngIf",t.showTooltip),i.xp6(3),i.hij("",t.label," "),i.xp6(1),i.Q6J("ngIf",t.isRequired())}}let D=(()=>{class u{constructor(t){this.fb=t,this.fetchByList=!0,this.control="",this.value="",this.bindLabel="",this.label="",this.placeholder="",this.data=new A.b,this.multiple=!1,this.addTag=!1,this.loading=!1,this.closeOnSelect=!0,this.maxSelectedItems=0,this.searchable=!0,this.searchOnInit=!1,this.typeToSearchText="Escriba 3 o m\xe1s caracteres",this.paramFilter="search",this.fetchItems=new i.vpe,this.fetchByParamsItems=new i.vpe,this.clear=new i.vpe,this.operator=e.ay.EQ,this.change=new i.vpe,this.readonly=!1,this.clearable=!0,this.showTooltip=!1,this.loadingInit=!1,this.className="",this.buffer=[],this.input$=new I.x,this.page=1,this.totalItems=0,this.inputAttrs={maxLength:""},this.title="",this.$unSubscribe=new I.x,this.concat=!1,this.selectSize=10}ngOnInit(){if(this.searchOnInit)if(this.fetchByList){this.loadingInit&&(this.loading=!0);const t=new e.NV;this.fetchItems.emit(t)}else{const t=new e.GQ;this.fetchByParamsItems.emit(t)}if(this.onSearch(),this.checkMaxAttribute(),this.showTooltip&&(this.updateTitle(),this.form&&this.control)){const t=this.form.get(this.control);t&&t.valueChanges.pipe((0,S.R)(this.$unSubscribe)).subscribe({next:c=>{null!=c&&this.updateTitle()},error:()=>{}})}}ngAfterViewInit(){this.labelTemplate&&this.ngSelect&&(this.ngSelect.labelTemplate=this.labelTemplate),this.optionTemplate&&this.ngSelect&&(this.ngSelect.optionTemplate=this.optionTemplate)}ngOnChanges(t){1==t.data?.currentValue?.reset&&(this.buffer=[],this.page=1),0===t.data?.currentValue?.length?this.buffer=[]:t.data&&this.concat?this.buffer=[...this.buffer,...this.data.data]:(this.buffer=this.data?.data,this.totalItems=this.data?.count),this.loading=!1}emitListParams(t){this.fetchItems.emit({page:this.page,text:t??"",limit:this.selectSize,search:t??""})}filterParams(t){let c=new e.GQ;c.page=this.page,c.limit=this.selectSize,"search"===this.paramFilter?c.search=t??"":t&&t.length>0&&c.addFilter(this.paramFilter,t,this.operator),this.fetchByParamsItems.emit(c)}fetchMore(t){!this.loading&&this.buffer.length<this.totalItems&&(this.page++,this.loading=!0,this.concat=!0,this.fetchByList?this.emitListParams(t):this.filterParams(t))}onSearch(){this.input$.pipe((0,l.b)(1e3),(0,y.x)(),(0,a.w)(t=>(null===t||(console.log(t),this.page=1,this.buffer=[],this.loading=!0,this.concat=!1,this.fetchByList?this.emitListParams(t):this.filterParams(t)),(0,m.of)([])))).subscribe()}onChange(t){this.change.emit(t),this.showTooltip&&t&&(t[this.bindLabel]?this.title=t[this.bindLabel]:t[this.value]&&(this.title=t[this.value]))}getLabel(t){return t[this.bindLabel]??""}isRequired(){if(this.form&&this.control){const t=this.form.get(this.control);if(t)return t.hasValidator(f.kI.required)}return!1}checkMaxAttribute(){null!=this.termMaxLength&&(this.inputAttrs.maxLength=this.termMaxLength)}updateTitle(){if(this.control&&this.form){const t=this.form.get(this.control);t&&("object"==typeof t.value&&null!=t.value?t.value[this.bindLabel]&&(this.title=t.value[this.bindLabel]):null!=t.value&&(this.title=t.value))}}ngOnDestroy(){this.$unSubscribe.next(),this.$unSubscribe.complete()}}return u.\u0275fac=function(t){return new(t||u)(i.Y36(f.qu))},u.\u0275cmp=i.Xpm({type:u,selectors:[["ngx-select"]],viewQuery:function(t,c){if(1&t&&i.Gf(g.w9,5),2&t){let v;i.iGM(v=i.CRH())&&(c.ngSelect=v.first)}},inputs:{form:"form",fetchByList:"fetchByList",control:"control",value:"value",bindLabel:"bindLabel",label:"label",placeholder:"placeholder",data:"data",multiple:"multiple",addTag:"addTag",loading:"loading",closeOnSelect:"closeOnSelect",maxSelectedItems:"maxSelectedItems",searchable:"searchable",searchOnInit:"searchOnInit",typeToSearchText:"typeToSearchText",paramFilter:"paramFilter",operator:"operator",readonly:"readonly",clearable:"clearable",termMaxLength:"termMaxLength",showTooltip:"showTooltip",labelTemplate:"labelTemplate",optionTemplate:"optionTemplate",loadingInit:"loadingInit",className:"className"},outputs:{fetchItems:"fetchItems",fetchByParamsItems:"fetchByParamsItems",clear:"clear",change:"change"},features:[i.TTD],decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"form-group","form-secondary","form-static-label","pt-2"],["notFoundText","No se encontraron elementos",1,"form-control",3,"clearable","items","bindLabel","hideSelected","closeOnSelect","maxSelectedItems","multiple","bindValue","minTermLength","loading","addTag","typeToSearchText","typeahead","virtualScroll","formControlName","searchable","placeholder","readonly","inputAttrs","title","scrollToEnd","change","clear"],["select",""],[4,"ngIf"],[1,"form-bar"],[1,"float-label"],[3,"color",4,"ngIf"],["ng-option-tmp",""],[3,"title"]],template:function(t,c){1&t&&i.YNc(0,x,9,25,"ng-container",0),2&t&&i.Q6J("ngIf",c.form)},dependencies:[R.O5,f.JJ,f.JL,f.sg,f.u,g.w9,g.ir],styles:[".form-control[_ngcontent-%COMP%]{height:auto!important}"]}),u})()}}]);