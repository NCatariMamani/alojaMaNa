"use strict";(self.webpackChunkalojamiento_frontend=self.webpackChunkalojamiento_frontend||[]).push([[45],{3045:(q,A,n)=>{n.r(A),n.d(A,{AccommodationsModule:()=>j});var p=n(6895),g=n(4385),h=n(1135),u=n(2722),l=n(168),v=n(8268),_=n(9267);const Z={id:{title:"ID",sort:!1,width:"10%"},nombre:{title:"Nombre de Alojamiento",sort:!1},noHabitaciones:{title:"No. Habitaci\xf3n",sort:!1},direccion:{title:"Direcci\xf3n",sort:!1},departamento:{title:"Departamento",sort:!1,type:"html",valuePrepareFunction:i=>"LP"==i?'<strong><span class="badge badge-pill badge-soft-info">LA PAZ</span></strong>':"OR"==i?'<strong><span class="badge badge-pill badge-soft-pink">ORURO</span></strong>':"PT"==i?'<strong><span class="badge badge-pill bg-info0">POTOSI</span></strong>':"CBBA"==i?'<strong><span class="badge badge-pill bg-info1">COCHABAMBA</span></strong>':"CH"==i?'<strong><span class="badge badge-pill bg-info2">CHUQUISACA</span></strong>':"TJA"==i?'<strong><span class="badge badge-pill bg-info3">TARIJA</span></strong>':"SCZ"==i?'<strong><span class="badge badge-pill bg-info4">SANTA CRUZ</span></strong>':"BE"==i?'<strong><span class="badge badge-pill bg-info5">BENI</span></strong>':"PD"==i?'<strong><span class="badge badge-pill bg-info6">PANDO</span></strong>':i,filter:{type:"list",config:{selectText:"Seleccionar",list:[{value:"LP",title:"LA PAZ"},{value:"OR",title:"ORURO"},{value:"PT",title:"POTOSI"},{value:"CBBA",title:"COCHABAMBA"},{value:"CH",title:"CHUQUISACA"},{value:"TJA",title:"TARIJA"},{value:"SCZ",title:"SANTA CRUZ"},{value:"BE",title:"BENI"},{value:"PD",title:"PANDO"}]}}}},S={id:{title:"ID",sort:!1,width:"10%"},noHabitacion:{title:"No. Habitaci\xf3n",sort:!1},preferencias:{title:"Preferencias",sort:!1},estado:{title:"Estado",sort:!1,type:"html",valuePrepareFunction:i=>"LIBRE"==i?'<strong><span class="badge badge-pill bg-disable-success">LIBRE</span></strong>':"SUCIO"==i?'<strong><span class="badge badge-pill badge-soft-pink">SUCIO</span></strong>':"OCUPADO"==i?'<strong><span class="badge badge-pill badge-soft-info">OCUPADO</span></strong>':i,filter:{type:"list",config:{selectText:"Seleccionar",list:[{value:"LIBRE",title:"LIBRE"},{value:"SUCIO",title:"SUCIO"},{value:"OCUPADO",title:"OCUPADO"}]}}}},N={id:{title:"ID",sort:!1,width:"10%"},descripcion:{title:"Descripci\xf3n",sort:!1},fecha:{title:"Fecha",sort:!1,valuePrepareFunction:i=>{var d=new Date(i);return new p.uU("en-EN").transform(d,"dd/MM/yyyy","UTC")},filter:{type:"custom",component:_.j}}};var r=n(4006),f=n(999),t=n(1571),b=n(388),C=n(6913),I=n(8796),x=n(312),O=n(4576),U=n(7597);let L=(()=>{class i extends v.nh{constructor(e,o,a){super(),this.modalRef=e,this.fb=o,this.accomodationService=a,this.form=new r.cw({}),this.title="ALOJAMIENTO",this.status="Nuevo",this.edit=!1}ngOnInit(){this.prepareForm()}prepareForm(){this.form=this.fb.group({nombre:[null,[r.kI.required,r.kI.pattern(f.Fv),r.kI.maxLength(100)]],noHabitaciones:[null,[r.kI.required,r.kI.pattern(f.bu),r.kI.maxLength(10)]],direccion:[null,[r.kI.required,r.kI.pattern(f.Fv),r.kI.maxLength(400)]],departamento:[null,[r.kI.required]]}),null!=this.accommodation&&(this.edit=!0,console.log(this.accommodation),this.form.patchValue(this.accommodation))}confirm(){this.edit?this.update():this.create()}create(){this.loading=!0;let e={nombre:this.form.controls.nombre.getRawValue(),noHabitaciones:Number(this.form.controls.noHabitaciones.getRawValue()),direccion:this.form.controls.direccion.getRawValue(),departamento:this.form.controls.departamento.getRawValue()};this.accomodationService.create(e).subscribe({next:o=>{this.handleSuccess(),this.loading=!1},error:o=>{this.loading=!1}})}handleSuccess(){this.alert("success",this.title,(this.edit?"Actualizada":"Guardada")+" Correctamente"),this.loading=!1,this.modalRef.content.callback(!0),this.modalRef.hide()}update(){if(this.accommodation){this.loading=!0;let e={nombre:this.form.controls.nombre.getRawValue(),noHabitaciones:Number(this.form.controls.noHabitaciones.getRawValue()),direccion:this.form.controls.direccion.getRawValue(),departamento:this.form.controls.departamento.getRawValue()};this.accomodationService.update(this.accommodation.id,e).subscribe({next:o=>{this.loading=!1,this.handleSuccess()},error:o=>{this.loading=!1}})}}close(){this.modalRef.hide()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(b.UZ),t.Y36(r.qu),t.Y36(C.A))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-accommodatio-detail"]],features:[t.qOj],decls:45,vars:11,consts:[["header",""],[1,"modal-title"],["body",""],[1,"form-material",3,"formGroup"],[1,"row"],[1,"col-md-5"],["label","Nombre de Alojamimento",3,"control"],["type","text","formControlName","nombre",1,"form-control"],[1,"col-md-2"],["label","No. Habitaci\xf3nes",3,"control"],["type","text","formControlName","noHabitaciones",1,"form-control"],["label","Departamento",3,"control"],["formControlName","departamento",1,"form-control",3,"searchable","clearable"],["value","LP"],["value","OR"],["value","PT"],["value","CBBA"],["value","CH"],["value","TJA"],["value","SCZ"],["value","BE"],["value","PD"],[1,"col-md-12","pt-4"],["label","Direcci\xf3n",3,"control"],["type","text","formControlName","direccion",1,"form-control"],["footer",""],[1,"d-flex","justify-content-center"],[1,"m-3"],[3,"type","disabled","confirm"],["type","button",1,"btn","btn-danger","active",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"app-modal")(1,"div",0)(2,"h5",1),t._uU(3),t.qZA()(),t.TgZ(4,"div",2)(5,"form",3)(6,"div",4)(7,"div",5)(8,"form-field",6),t._UZ(9,"input",7),t.qZA()(),t.TgZ(10,"div",8)(11,"form-field",9),t._UZ(12,"input",10),t.qZA()(),t.TgZ(13,"div",5)(14,"form-field",11)(15,"ng-select",12)(16,"ng-option",13),t._uU(17,"LA PAZ"),t.qZA(),t.TgZ(18,"ng-option",14),t._uU(19,"ORURO"),t.qZA(),t.TgZ(20,"ng-option",15),t._uU(21,"POTOSI"),t.qZA(),t.TgZ(22,"ng-option",16),t._uU(23,"COCHABAMBA"),t.qZA(),t.TgZ(24,"ng-option",17),t._uU(25,"CHUQUISACA"),t.qZA(),t.TgZ(26,"ng-option",18),t._uU(27,"TARIJA"),t.qZA(),t.TgZ(28,"ng-option",19),t._uU(29,"SANTA CRUZ"),t.qZA(),t.TgZ(30,"ng-option",20),t._uU(31,"BENI"),t.qZA(),t.TgZ(32,"ng-option",21),t._uU(33,"PANDO"),t.qZA()()()()(),t.TgZ(34,"div",4)(35,"div",22)(36,"form-field",23),t._UZ(37,"input",24),t.qZA()()()()(),t.TgZ(38,"div",25)(39,"div",26)(40,"div",27)(41,"confirm-button",28),t.NdJ("confirm",function(){return o.confirm()}),t.qZA()(),t.TgZ(42,"div",27)(43,"button",29),t.NdJ("click",function(){return o.close()}),t._uU(44," Cancelar "),t.qZA()()()()()),2&e&&(t.xp6(3),t.AsE("",o.edit?"Editar":"Nuevo"," ",o.title,""),t.xp6(2),t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("control",o.form.get("nombre")),t.xp6(3),t.Q6J("control",o.form.get("noHabitaciones")),t.xp6(3),t.Q6J("control",o.form.get("departamento")),t.xp6(1),t.Q6J("searchable",!1)("clearable",!1),t.xp6(21),t.Q6J("control",o.form.get("direccion")),t.xp6(5),t.Q6J("type","button")("disabled",o.form.invalid))},dependencies:[r._Y,r.Fj,r.JJ,r.JL,I.w9,I.jq,x.z,O.h,U.f,r.sg,r.u]}),i})();var R=n(8218),E=n(9865),w=n(5397),y=n(6043),B=n(5358),H=n(9219),J=n(2243),M=n(4554);function D(i,d){if(1&i){const e=t.EpF();t.TgZ(0,"div",7)(1,"button",8),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.openModal2())}),t._uU(2," Nuevo "),t._UZ(3,"i",9),t.qZA()()}}function F(i,d){if(1&i){const e=t.EpF();t.TgZ(0,"div",7)(1,"button",8),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.openModal3())}),t._uU(2," Nuevo "),t._UZ(3,"i",9),t.qZA()()}}function Q(i,d){if(1&i){const e=t.EpF();t.TgZ(0,"div",16)(1,"div",17)(2,"div",1)(3,"h5",2),t._uU(4,"HABITACIONES"),t.qZA()(),t.TgZ(5,"div",4),t._UZ(6,"div",5),t.TgZ(7,"div",6),t.YNc(8,D,4,0,"div",18),t.TgZ(9,"app-columns-select",10),t.NdJ("settingsChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.settings2=a)}),t.qZA()()(),t.TgZ(10,"div",4)(11,"div",11)(12,"div")(13,"div",12)(14,"ng2-smart-table",19),t.NdJ("edit",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.edit2(a.data))})("delete",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.showDeleteAlert2(a.data))}),t.qZA()(),t._UZ(15,"app-pagination",14),t.qZA()()()(),t.TgZ(16,"div",17)(17,"div",1)(18,"h5",2),t._uU(19,"INVENTARIOS"),t.qZA()(),t.TgZ(20,"div",4),t._UZ(21,"div",5),t.TgZ(22,"div",6),t.YNc(23,F,4,0,"div",18),t.TgZ(24,"app-columns-select",10),t.NdJ("settingsChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.settings3=a)}),t.qZA()()(),t.TgZ(25,"div",4)(26,"div",11)(27,"div")(28,"div",12)(29,"ng2-smart-table",20),t.NdJ("edit",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.edit3(a.data))})("delete",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.showDeleteAlert3(a.data))})("userRowSelect",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.rowsSelected1(a))}),t.qZA()(),t._UZ(30,"app-pagination",14),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(8),t.Q6J("ngIf",e.valueButton),t.xp6(1),t.Q6J("settings",e.settings2)("leftList",!0),t.xp6(3),t.Tol(e.loading?"table-loading":""),t.xp6(2),t.Q6J("settings",e.settings2)("source",e.data2),t.xp6(1),t.Q6J("params",e.params2)("totalItems",e.totalItems2),t.xp6(8),t.Q6J("ngIf",e.totalItems3<1),t.xp6(1),t.Q6J("settings",e.settings3)("leftList",!0),t.xp6(3),t.Tol(e.loading?"table-loading":""),t.xp6(2),t.Q6J("settings",e.settings3)("source",e.data3),t.xp6(1),t.Q6J("params",e.params3)("totalItems",e.totalItems3)}}let P=(()=>{class i extends v.nh{constructor(e,o,a,s){super(),this.modalService=e,this.accomodationService=o,this.bedroomsService=a,this.inventoriesService=s,this.data=new g.nC,this.data2=new g.nC,this.data3=new g.nC,this.params=new h.X(new l.NV),this.params2=new h.X(new l.NV),this.params3=new h.X(new l.NV),this.columnFilters=[],this.columnFilters2=[],this.columnFilters3=[],this.totalItems=0,this.totalItems2=0,this.totalItems3=0,this.idAccom=0,this.valueButton=!1,this.bedrooms=!1,this.settings2={...this.settings},this.settings3={...this.settings},this.settings={...this.settings,hideSubHeader:!1,actions:{columnTitle:"Acciones",edit:!0,delete:!0,add:!1,position:"right"},columns:{...Z}},this.settings2={...this.settings,hideSubHeader:!1,actions:{columnTitle:"Acciones",edit:!0,delete:!0,add:!1,position:"right"},columns:{...S}},this.settings3={...this.settings,hideSubHeader:!1,actions:{columnTitle:"Acciones",edit:!0,delete:!0,add:!1,position:"right"},columns:{...N}}}ngOnInit(){this.data.onChanged().pipe((0,u.R)(this.$unSubscribe)).subscribe(e=>{"filter"===e.action&&(e.filter.filters.map(a=>{let s="",c=l.ay.ILIKE;switch(s=`filter.${a.field}`,a.field){case"id":case"noHabitaciones":c=l.ay.EQ;break;default:c=l.ay.ILIKE}""!==a.search?this.columnFilters[s]=`${c}:${a.search}`:delete this.columnFilters[s]}),this.params=this.pageFilter(this.params),this.getAllAcommodations())}),this.params.pipe((0,u.R)(this.$unSubscribe)).subscribe(()=>this.getAllAcommodations())}getAllAcommodations(){console.log("hola"),this.loading=!0;let e={...this.params.getValue(),...this.columnFilters};this.accomodationService.getAll(e).subscribe({next:o=>{console.log(o),this.data.load(o.data),this.data.refresh(),this.totalItems=o.count,this.loading=!1},error:o=>{this.loading=!1,this.data.load([])}})}rowsSelected(e){console.log(e.data),this.rowSelect=e.data,e&&(this.bedrooms=!0,this.idAccom=e.data.id,this.noHab=e.data.noHabitaciones,console.log(this.noHab),this.params2.getValue()["filter.alojamientoId"]=`${l.ay.EQ}:${this.rowSelect.id}`,this.data2.onChanged().pipe((0,u.R)(this.$unSubscribe)).subscribe(o=>{"filter"===o.action&&(o.filter.filters.map(s=>{let c="",m=l.ay.ILIKE;switch(c=`filter.${s.field}`,s.field){case"id":case"noHabitacion":m=l.ay.EQ;break;default:m=l.ay.ILIKE}""!==s.search?this.columnFilters2[c]=`${m}:${s.search}`:delete this.columnFilters2[c]}),this.params2=this.pageFilter(this.params2),this.getBeddroms())}),this.params2.pipe((0,u.R)(this.$unSubscribe)).subscribe(()=>this.getBeddroms()),this.params3.getValue()["filter.alojamientoId"]=`${l.ay.EQ}:${this.rowSelect.id}`,this.data3.onChanged().pipe((0,u.R)(this.$unSubscribe)).subscribe(o=>{"filter"===o.action&&(o.filter.filters.map(s=>{let c="",m=l.ay.ILIKE;switch(c=`filter.${s.field}`,s.field){case"id":m=l.ay.EQ;break;case"fecha":s.search=this.returnParseDate(s.search),m=l.ay.EQ;break;case"alojamientos":m=l.ay.ILIKE,c=`filter.${s.field}.nombre`;break;default:m=l.ay.ILIKE}""!==s.search?this.columnFilters3[c]=`${m}:${s.search}`:delete this.columnFilters3[c]}),this.params3=this.pageFilter(this.params3),this.getAllInventories())}),this.params3.pipe((0,u.R)(this.$unSubscribe)).subscribe(()=>this.getAllInventories()))}getBeddroms(){this.loading=!0;let e={...this.params2.getValue(),...this.columnFilters2};this.bedroomsService.getAll(e).subscribe({next:o=>{console.log(this.noHab),this.data2.load(o.data),this.data2.refresh(),this.totalItems2=o.count,this.noHab&&(this.valueButton=this.totalItems2<this.noHab+1),this.loading=!1},error:o=>{this.loading=!1,this.data2.load([])}})}getAllInventories(){this.loading=!0;let e={...this.params3.getValue(),...this.columnFilters3};this.inventoriesService.getAll(e).subscribe({next:o=>{console.log(o),this.data3.load(o.data),this.data3.refresh(),this.totalItems3=o.count,this.loading=!1},error:o=>{this.loading=!1,this.data3.load([])}})}edit(e){this.openModal(e)}edit2(e){this.openModal2(e)}edit3(e){this.openModal3(e)}openModal(e){this.modalService.show(L,{initialState:{accommodation:e,callback:a=>{a&&this.getAllAcommodations()}},class:"modal-lg modal-dialog-centered",ignoreBackdropClick:!0})}openModal2(e){this.modalService.show(R.q,{initialState:{idAccom:this.idAccom,bedroom:e,noHabi:this.noHab,callback:c=>{c&&this.getBeddroms()}},class:"modal-lg modal-dialog-centered",ignoreBackdropClick:!0})}openModal3(e){this.modalService.show(E.x,{initialState:{idAccom:this.idAccom,inventories:e,callback:s=>{s&&this.getAllInventories()}},class:"modal-lg modal-dialog-centered",ignoreBackdropClick:!0})}showDeleteAlert(e){this.alertQuestion("warning","Eliminar","\xbfDesea eliminar este registro?").then(o=>{o.isConfirmed&&this.delete(e.id)})}showDeleteAlert2(e){this.alertQuestion("warning","Eliminar","\xbfDesea eliminar este registro?").then(o=>{o.isConfirmed&&this.delete2(e.id)})}showDeleteAlert3(e){this.alertQuestion("warning","Eliminar","\xbfDesea eliminar este registro?").then(o=>{o.isConfirmed&&this.delete3(e.id)})}delete(e){this.accomodationService.remove(e).subscribe({next:()=>{this.alert("success","ALOJAMIENTO","Borrado Correctamente"),this.params.pipe((0,u.R)(this.$unSubscribe)).subscribe(()=>this.getAllAcommodations())},error:o=>{this.alert("error","No se logro Eliminar","Existe una relacion")}})}delete2(e){this.bedroomsService.remove(e).subscribe({next:()=>{this.alert("success","HABITACI\xd3N","Borrado Correctamente"),this.params2.pipe((0,u.R)(this.$unSubscribe)).subscribe(()=>this.getBeddroms())},error:o=>{this.alert("error","No se logro Eliminar","Existe una relacion")}})}delete3(e){this.inventoriesService.remove(e).subscribe({next:()=>{this.alert("success","INVENTARIO","Borrado Correctamente"),this.params3.pipe((0,u.R)(this.$unSubscribe)).subscribe(()=>this.getAllInventories())},error:o=>{this.alert("error","No se logro Eliminar","Existe una relacion")}})}rowsSelected1(e){console.log(e),this.openModal4(e)}openModal4(e){console.log(e.data);const o=e.data?.id;this.modalService.show(w.S,{initialState:{idInventory:o,validButton:!0,validProduct:!0,departmen:this.rowSelect.departamento,callback:K=>{K&&this.getAllInventories()}},class:"modal-xl modal-dialog-centered",ignoreBackdropClick:!0})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(b.tT),t.Y36(C.A),t.Y36(y.c),t.Y36(B.H))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-accommodation-list"]],features:[t.qOj],decls:20,vars:10,consts:[[3,"header"],["header","",1,"ch-content"],[1,"title"],["body",""],[1,"row"],[1,"col-md-8","mb-3"],[1,"col-md-4","text-end","d-flex","flex-row-reverse","mb-3"],[1,"mr-3"],["type","button","tooltip","Nuevo","containerclass","tooltip-style",1,"btn","btn-info","btn-sm","active","d-flex","justify-content-center","align-items-center","ml-3",3,"click"],[1,"bx","bx-plus","bx-sm","ml-2"],[3,"settings","leftList","settingsChange"],[1,"col-md-12"],[1,"table-responsive"],[3,"settings","source","edit","userRowSelect","delete"],[3,"params","totalItems"],["class","mt-5",4,"ngIf"],[1,"mt-5"],[1,"col-md-6"],["class","mr-3",4,"ngIf"],[3,"settings","source","edit","delete"],[3,"settings","source","edit","delete","userRowSelect"]],template:function(e,o){1&e&&(t.TgZ(0,"app-card",0)(1,"div",1)(2,"h5",2),t._uU(3,"ALOJAMIENTOS"),t.qZA()(),t.TgZ(4,"div",3)(5,"div",4),t._UZ(6,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"button",8),t.NdJ("click",function(){return o.openModal()}),t._uU(10," Nuevo "),t._UZ(11,"i",9),t.qZA()(),t.TgZ(12,"app-columns-select",10),t.NdJ("settingsChange",function(s){return o.settings=s}),t.qZA()()(),t.TgZ(13,"div",4)(14,"div",11)(15,"div")(16,"div",12)(17,"ng2-smart-table",13),t.NdJ("edit",function(s){return o.edit(s.data)})("userRowSelect",function(s){return o.rowsSelected(s)})("delete",function(s){return o.showDeleteAlert(s.data)}),t.qZA()(),t._UZ(18,"app-pagination",14),t.qZA()()(),t.YNc(19,Q,31,18,"div",15),t.qZA()()),2&e&&(t.Q6J("header",!0),t.xp6(12),t.Q6J("settings",o.settings)("leftList",!0),t.xp6(3),t.Tol(o.loading?"table-loading":""),t.xp6(2),t.Q6J("settings",o.settings)("source",o.data),t.xp6(1),t.Q6J("params",o.params)("totalItems",o.totalItems),t.xp6(1),t.Q6J("ngIf",o.bedrooms))},dependencies:[p.O5,H.A,J.L,g.T5,M.Q]}),i})();var T=n(6646);const k=[{path:"",component:P}];let $=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[T.Bz.forChild(k),T.Bz]}),i})();var V=n(8909);let j=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,$,V.m8,b.zk.forChild()]}),i})()}}]);