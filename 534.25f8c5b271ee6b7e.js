"use strict";(self.webpackChunkalojamiento_frontend=self.webpackChunkalojamiento_frontend||[]).push([[534],{6913:(I,d,r)=>{r.d(d,{A:()=>u});var o=r(5551),h=r(8463),m=r(1571),c=r(4833);let u=(()=>{class t extends h.O{constructor(n){super(),this.accomodationRepo=n,this.router=o.J.Alojamientos}getAll(n){return this.accomodationRepo.getAll(this.router,n)}getById(n){return this.accomodationRepo.getById(this.router,n)}create(n){return this.accomodationRepo.create(this.router,n)}update(n,_){return this.accomodationRepo.updateTypeServices(this.router,n,_)}remove(n){return this.accomodationRepo.remove(this.router,n)}}return t.\u0275fac=function(n){return new(n||t)(m.LFG(c._))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},7795:(I,d,r)=>{r.d(d,{t:()=>u});var o=r(5551),h=r(8463),m=r(1571),c=r(4833);let u=(()=>{class t extends h.O{constructor(n){super(),this.usersRepo=n,this.router=o.J.Encargados}getAll(n){return this.usersRepo.getAll(this.router,n)}getById(n){return this.usersRepo.getById(this.router,n)}getAllHabUserById(n,_){return this.usersRepo.getById02(`${this.router}/getByEncargadoUser`,n,_)}create(n){return this.usersRepo.create(this.router,n)}update(n,_){return this.usersRepo.updateTypeServices(this.router,n,_)}remove(n){return this.usersRepo.remove(this.router,n)}}return t.\u0275fac=function(n){return new(n||t)(m.LFG(c._))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},2118:(I,d,r)=>{r.d(d,{f:()=>u});var o=r(5551),h=r(8463),m=r(1571),c=r(4833);let u=(()=>{class t extends h.O{constructor(n){super(),this.usersRepo=n,this.router=o.J.Users}getAll(n){return this.usersRepo.getAll(this.router,n)}getById(n){return this.usersRepo.getById(this.router,n)}create(n){return this.usersRepo.create(this.router,n)}update(n,_){return this.usersRepo.updateTypeServices(this.router,n,_)}remove(n){return this.usersRepo.remove(this.router,n)}}return t.\u0275fac=function(n){return new(n||t)(m.LFG(c._))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},999:(I,d,r)=>{r.d(d,{Fv:()=>p,K2:()=>v,QI:()=>o,bu:()=>m});const o="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,4}$",m="^-?[0-9]+$",v="[+]?([0-9]*[.])?[0-9]+",p='(?![\\s])[a-zA-Z0-9\xe1\xe8\xe9\xed\xf3\xfa\xc1\xc8\xc9\xcd\xd3\xda\xf1\xd1\\/\\s\\.,_\\-\\\\()$\xb0\\\xdc\xfc\u201c\u201d"";:%]*'},4534:(I,d,r)=>{r.d(d,{v:()=>M});var o=r(4006),h=r(168),m=r(8268),c=r(999),u=r(4553),t=r(1571),f=r(388),n=r(6913),_=r(2118),v=r(7795),p=r(6895),A=r(8796),R=r(312),b=r(4576),C=r(7597),P=r(7209);let M=(()=>{class g extends m.nh{constructor(s,e,a,l,E,L){super(),this.modalRef=s,this.fb=e,this.accomodationService=a,this.usersService=l,this.inChargeService=E,this.datePipe=L,this.form=new o.cw({}),this.title="ENCARGADO",this.status="Nuevo",this.edit=!1,this.maxDate=new Date,this.user=0,this.accomodations=new u.b,this.users=new u.b}ngOnInit(){this.prepareForm()}prepareForm(){this.form=this.fb.group({nombre:[null,[o.kI.required,o.kI.pattern(c.Fv)]],paterno:[null,[o.kI.required,o.kI.pattern(c.Fv)]],materno:[null,[o.kI.required,o.kI.pattern(c.Fv)]],ci:[null,[o.kI.required,o.kI.pattern(c.Fv)]],ext:[null,[o.kI.required,o.kI.pattern(c.Fv)]],celular:[null,[o.kI.required,o.kI.pattern(c.Fv)]],alojamientoId:[null,[o.kI.required,o.kI.pattern(c.Fv)]],userId:[this.user,[o.kI.required,o.kI.pattern(c.Fv)]]}),this.form.controls.userId.disable(),null!=this.inCharges&&(this.edit=!0,this.form.patchValue(this.inCharges)),setTimeout(()=>{this.getAccomodation(new h.NV),this.getUsers(new h.NV)},1e3)}confirm(){this.edit?this.update():this.create()}create(){this.loading=!0;let s={nombre:this.form.controls.nombre.getRawValue(),paterno:this.form.controls.paterno.getRawValue(),materno:this.form.controls.materno.getRawValue(),ci:Number(this.form.controls.ci.getRawValue()),ext:this.form.controls.ext.getRawValue(),celular:Number(this.form.controls.celular.getRawValue()),alojamientoId:Number(this.form.controls.alojamientoId.getRawValue()),userId:Number(this.form.controls.userId.getRawValue())};this.inChargeService.create(s).subscribe({next:e=>{this.handleSuccess(),this.loading=!1},error:e=>{this.loading=!1}})}handleSuccess(){this.alert("success",this.title,(this.edit?"Actualizada":"Guardada")+" Correctamente"),this.loading=!1,this.modalRef.content.callback(!0),this.modalRef.hide()}update(){if(this.inCharges){this.loading=!0;let s={nombre:this.form.controls.nombre.getRawValue(),paterno:this.form.controls.paterno.getRawValue(),materno:this.form.controls.materno.getRawValue(),ci:Number(this.form.controls.ci.getRawValue()),ext:this.form.controls.ext.getRawValue(),celular:Number(this.form.controls.celular.getRawValue()),alojamientoId:Number(this.form.controls.alojamientoId.getRawValue()),userId:Number(this.form.controls.userId.getRawValue())};this.inChargeService.update(this.inCharges.id,s).subscribe({next:e=>{this.loading=!1,this.handleSuccess()},error:e=>{this.loading=!1}})}}close(){this.modalRef.hide()}getAccomodation(s){s.text&&(s["filter.nombre"]=`$ilike:${s.text}`),this.accomodationService.getAll(s).subscribe({next:e=>{this.accomodations=new u.b(e.data,e.count)},error:e=>{this.accomodations=new u.b,this.loading=!1}})}onChangeAccomodation(s){console.log(s)}getUsers(s){s.text&&(s["filter.nombre"]=`$ilike:${s.text}`),this.usersService.getAll(s).subscribe({next:e=>{this.users=new u.b(e.data,e.count)},error:e=>{this.users=new u.b,this.loading=!1}})}onChangeUsers(s){console.log(s)}validateDate(s){s&&(this.editDate=s)}}return g.\u0275fac=function(s){return new(s||g)(t.Y36(f.UZ),t.Y36(o.qu),t.Y36(n.A),t.Y36(_.f),t.Y36(v.t),t.Y36(p.uU))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-inCharge-detail"]],features:[t.qOj],decls:58,vars:21,consts:[["header",""],[1,"modal-title"],["body",""],[1,"form-material",3,"formGroup"],[1,"row"],[1,"col-md-6"],["label","Nombre",3,"control"],["type","text","formControlName","nombre",1,"form-control"],["label","Paterno",3,"control"],["type","text","formControlName","paterno",1,"form-control"],[1,"row","pt-4"],["label","Materno",3,"control"],["type","text","formControlName","materno",1,"form-control"],[1,"col-md-4"],["label","CI",3,"control"],["type","number","formControlName","ci","maxlength","15","min","1","oninput","if(this.value.length > 10) this.value = this.value.slice(0, 10);",1,"form-control"],[1,"col-md-2"],["label","Expedido",3,"control"],["formControlName","ext",1,"form-control",3,"searchable","clearable"],["value","LP"],["value","OR"],["value","PT"],["value","CBBA"],["value","CH"],["value","TJA"],["value","SCZ"],["value","BE"],["value","PD"],["label","Celular",3,"control"],["type","number","formControlName","celular","maxlength","8","min","1","oninput","if(this.value.length > 8) this.value = this.value.slice(0, 8);",1,"form-control"],[3,"control"],["control","alojamientoId","bindLabel","nombre","label","Alojamiento","value","id",3,"form","data","readonly","fetchItems","change"],["control","userId","bindLabel","email","label","Usuario","value","id",3,"form","data","readonly","fetchItems","change"],["footer",""],[1,"d-flex","justify-content-center"],[1,"m-3"],[3,"type","disabled","confirm"],["type","button",1,"btn","btn-danger","active",3,"click"]],template:function(s,e){1&s&&(t.TgZ(0,"app-modal")(1,"div",0)(2,"h5",1),t._uU(3),t.qZA()(),t.TgZ(4,"div",2)(5,"form",3)(6,"div",4)(7,"div",5)(8,"form-field",6),t._UZ(9,"input",7),t.qZA()(),t.TgZ(10,"div",5)(11,"form-field",8),t._UZ(12,"input",9),t.qZA()()(),t.TgZ(13,"div",10)(14,"div",5)(15,"form-field",11),t._UZ(16,"input",12),t.qZA()(),t.TgZ(17,"div",13)(18,"form-field",14),t._UZ(19,"input",15),t.qZA()(),t.TgZ(20,"div",16)(21,"form-field",17)(22,"ng-select",18)(23,"ng-option",19),t._uU(24,"LP"),t.qZA(),t.TgZ(25,"ng-option",20),t._uU(26,"OR"),t.qZA(),t.TgZ(27,"ng-option",21),t._uU(28,"PT"),t.qZA(),t.TgZ(29,"ng-option",22),t._uU(30,"CBBA"),t.qZA(),t.TgZ(31,"ng-option",23),t._uU(32,"CH"),t.qZA(),t.TgZ(33,"ng-option",24),t._uU(34,"TJA"),t.qZA(),t.TgZ(35,"ng-option",25),t._uU(36,"SCZ"),t.qZA(),t.TgZ(37,"ng-option",26),t._uU(38,"BE"),t.qZA(),t.TgZ(39,"ng-option",27),t._uU(40,"PD"),t.qZA()()()()(),t.TgZ(41,"div",10)(42,"div",13)(43,"form-field",28),t._UZ(44,"input",29),t.qZA()(),t.TgZ(45,"div",13)(46,"form-field",30)(47,"ngx-select",31),t.NdJ("fetchItems",function(l){return e.getAccomodation(l)})("change",function(l){return e.onChangeAccomodation(l)}),t.qZA()()(),t.TgZ(48,"div",13)(49,"form-field",30)(50,"ngx-select",32),t.NdJ("fetchItems",function(l){return e.getUsers(l)})("change",function(l){return e.onChangeUsers(l)}),t.qZA()()()()()(),t.TgZ(51,"div",33)(52,"div",34)(53,"div",35)(54,"confirm-button",36),t.NdJ("confirm",function(){return e.confirm()}),t.qZA()(),t.TgZ(55,"div",35)(56,"button",37),t.NdJ("click",function(){return e.close()}),t._uU(57," Cancelar "),t.qZA()()()()()),2&s&&(t.xp6(3),t.AsE("",e.edit?"Editar":"Nuevo"," ",e.title,""),t.xp6(2),t.Q6J("formGroup",e.form),t.xp6(3),t.Q6J("control",e.form.get("nombre")),t.xp6(3),t.Q6J("control",e.form.get("paterno")),t.xp6(4),t.Q6J("control",e.form.get("materno")),t.xp6(3),t.Q6J("control",e.form.get("ci")),t.xp6(3),t.Q6J("control",e.form.get("ext")),t.xp6(1),t.Q6J("searchable",!1)("clearable",!1),t.xp6(21),t.Q6J("control",e.form.get("celular")),t.xp6(3),t.Q6J("control",e.form.get("alojamientoId")),t.xp6(1),t.Q6J("form",e.form)("data",e.accomodations)("readonly",!1),t.xp6(2),t.Q6J("control",e.form.get("userId")),t.xp6(1),t.Q6J("form",e.form)("data",e.users)("readonly",!1),t.xp6(4),t.Q6J("type","button")("disabled",e.form.invalid))},dependencies:[o._Y,o.Fj,o.wV,o.JJ,o.JL,o.nD,o.qQ,A.w9,A.jq,R.z,b.h,C.f,o.sg,o.u,P.H]}),g})()},7209:(I,d,r)=>{r.d(d,{H:()=>g});var o=r(1571),h=r(4006),m=r(8796),c=r(7579),u=r(2722),t=r(8372),f=r(1884),n=r(3900),_=r(9646),p=r(168),A=r(4553),R=r(6895);function b(i,s){if(1&i&&(o.TgZ(0,"div",10),o._uU(1),o.qZA()),2&i){const e=s.item,a=o.oxw(3);o.Q6J("title",e[a.bindLabel]),o.xp6(1),o.Oqu(e[a.bindLabel])}}function C(i,s){1&i&&o.YNc(0,b,2,2,"ng-template",9)}function P(i,s){1&i&&(o.TgZ(0,"span"),o._uU(1,"*"),o.qZA()),2&i&&o.Udp("color","#9D2449")}function M(i,s){if(1&i){const e=o.EpF();o.ynx(0,1),o.TgZ(1,"div",2)(2,"ng-select",3,4),o.NdJ("scrollToEnd",function(){o.CHM(e);const l=o.MAs(3),E=o.oxw();return o.KtG(E.fetchMore(l.searchTerm))})("change",function(l){o.CHM(e);const E=o.oxw();return o.KtG(E.onChange(l))})("clear",function(){o.CHM(e);const l=o.oxw();return o.KtG(l.clear.emit())}),o.YNc(4,C,1,0,null,5),o.qZA(),o._UZ(5,"span",6),o.TgZ(6,"label",7),o._uU(7),o.YNc(8,P,2,2,"span",8),o.qZA()(),o.BQk()}if(2&i){const e=o.oxw();o.Q6J("formGroup",e.form),o.xp6(2),o.Q6J("clearable",e.clearable)("items",e.buffer)("bindLabel",e.bindLabel)("hideSelected",!0)("closeOnSelect",e.closeOnSelect)("maxSelectedItems",e.maxSelectedItems)("multiple",e.multiple)("bindValue",e.value)("minTermLength",0)("loading",e.loading)("addTag",e.addTag)("typeToSearchText",e.typeToSearchText)("typeahead",e.input$)("virtualScroll",!0)("formControlName",e.control)("searchable",e.searchable)("placeholder",e.placeholder)("readonly",e.readonly)("inputAttrs",e.inputAttrs)("title",e.title),o.uIk("class",e.className+" form-control"),o.xp6(2),o.Q6J("ngIf",e.showTooltip),o.xp6(3),o.hij("",e.label," "),o.xp6(1),o.Q6J("ngIf",e.isRequired())}}let g=(()=>{class i{constructor(e){this.fb=e,this.fetchByList=!0,this.control="",this.value="",this.bindLabel="",this.label="",this.placeholder="",this.data=new A.b,this.multiple=!1,this.addTag=!1,this.loading=!1,this.closeOnSelect=!0,this.maxSelectedItems=0,this.searchable=!0,this.searchOnInit=!1,this.typeToSearchText="Escriba 3 o m\xe1s caracteres",this.paramFilter="search",this.fetchItems=new o.vpe,this.fetchByParamsItems=new o.vpe,this.clear=new o.vpe,this.operator=p.ay.EQ,this.change=new o.vpe,this.readonly=!1,this.clearable=!0,this.showTooltip=!1,this.loadingInit=!1,this.className="",this.buffer=[],this.input$=new c.x,this.page=1,this.totalItems=0,this.inputAttrs={maxLength:""},this.title="",this.$unSubscribe=new c.x,this.concat=!1,this.selectSize=10}ngOnInit(){if(this.searchOnInit)if(this.fetchByList){this.loadingInit&&(this.loading=!0);const e=new p.NV;this.fetchItems.emit(e)}else{const e=new p.GQ;this.fetchByParamsItems.emit(e)}if(this.onSearch(),this.checkMaxAttribute(),this.showTooltip&&(this.updateTitle(),this.form&&this.control)){const e=this.form.get(this.control);e&&e.valueChanges.pipe((0,u.R)(this.$unSubscribe)).subscribe({next:a=>{null!=a&&this.updateTitle()},error:()=>{}})}}ngAfterViewInit(){this.labelTemplate&&this.ngSelect&&(this.ngSelect.labelTemplate=this.labelTemplate),this.optionTemplate&&this.ngSelect&&(this.ngSelect.optionTemplate=this.optionTemplate)}ngOnChanges(e){1==e.data?.currentValue?.reset&&(this.buffer=[],this.page=1),0===e.data?.currentValue?.length?this.buffer=[]:e.data&&this.concat?this.buffer=[...this.buffer,...this.data.data]:(this.buffer=this.data?.data,this.totalItems=this.data?.count),this.loading=!1}emitListParams(e){this.fetchItems.emit({page:this.page,text:e??"",limit:this.selectSize,search:e??""})}filterParams(e){let a=new p.GQ;a.page=this.page,a.limit=this.selectSize,"search"===this.paramFilter?a.search=e??"":e&&e.length>0&&a.addFilter(this.paramFilter,e,this.operator),this.fetchByParamsItems.emit(a)}fetchMore(e){!this.loading&&this.buffer.length<this.totalItems&&(this.page++,this.loading=!0,this.concat=!0,this.fetchByList?this.emitListParams(e):this.filterParams(e))}onSearch(){this.input$.pipe((0,t.b)(1e3),(0,f.x)(),(0,n.w)(e=>(null===e||(console.log(e),this.page=1,this.buffer=[],this.loading=!0,this.concat=!1,this.fetchByList?this.emitListParams(e):this.filterParams(e)),(0,_.of)([])))).subscribe()}onChange(e){this.change.emit(e),this.showTooltip&&e&&(e[this.bindLabel]?this.title=e[this.bindLabel]:e[this.value]&&(this.title=e[this.value]))}getLabel(e){return e[this.bindLabel]??""}isRequired(){if(this.form&&this.control){const e=this.form.get(this.control);if(e)return e.hasValidator(h.kI.required)}return!1}checkMaxAttribute(){null!=this.termMaxLength&&(this.inputAttrs.maxLength=this.termMaxLength)}updateTitle(){if(this.control&&this.form){const e=this.form.get(this.control);e&&("object"==typeof e.value&&null!=e.value?e.value[this.bindLabel]&&(this.title=e.value[this.bindLabel]):null!=e.value&&(this.title=e.value))}}ngOnDestroy(){this.$unSubscribe.next(),this.$unSubscribe.complete()}}return i.\u0275fac=function(e){return new(e||i)(o.Y36(h.qu))},i.\u0275cmp=o.Xpm({type:i,selectors:[["ngx-select"]],viewQuery:function(e,a){if(1&e&&o.Gf(m.w9,5),2&e){let l;o.iGM(l=o.CRH())&&(a.ngSelect=l.first)}},inputs:{form:"form",fetchByList:"fetchByList",control:"control",value:"value",bindLabel:"bindLabel",label:"label",placeholder:"placeholder",data:"data",multiple:"multiple",addTag:"addTag",loading:"loading",closeOnSelect:"closeOnSelect",maxSelectedItems:"maxSelectedItems",searchable:"searchable",searchOnInit:"searchOnInit",typeToSearchText:"typeToSearchText",paramFilter:"paramFilter",operator:"operator",readonly:"readonly",clearable:"clearable",termMaxLength:"termMaxLength",showTooltip:"showTooltip",labelTemplate:"labelTemplate",optionTemplate:"optionTemplate",loadingInit:"loadingInit",className:"className"},outputs:{fetchItems:"fetchItems",fetchByParamsItems:"fetchByParamsItems",clear:"clear",change:"change"},features:[o.TTD],decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"form-group","form-secondary","form-static-label","pt-2"],["notFoundText","No se encontraron elementos",1,"form-control",3,"clearable","items","bindLabel","hideSelected","closeOnSelect","maxSelectedItems","multiple","bindValue","minTermLength","loading","addTag","typeToSearchText","typeahead","virtualScroll","formControlName","searchable","placeholder","readonly","inputAttrs","title","scrollToEnd","change","clear"],["select",""],[4,"ngIf"],[1,"form-bar"],[1,"float-label"],[3,"color",4,"ngIf"],["ng-option-tmp",""],[3,"title"]],template:function(e,a){1&e&&o.YNc(0,M,9,25,"ng-container",0),2&e&&o.Q6J("ngIf",a.form)},dependencies:[R.O5,h.JJ,h.JL,h.sg,h.u,m.w9,m.ir],styles:[".form-control[_ngcontent-%COMP%]{height:auto!important}"]}),i})()}}]);