"use strict";(self.webpackChunkalojamiento_frontend=self.webpackChunkalojamiento_frontend||[]).push([[21],{6891:(N,f,n)=>{n.d(f,{s:()=>h});var g=n(5551),R=n(8463),c=n(1571),d=n(4833);let h=(()=>{class a extends R.O{constructor(l){super(),this.productsRepo=l,this.router=g.J.Productos}getAll(l){return this.productsRepo.getAll(this.router,l)}getById(l){return this.productsRepo.getById(this.router,l)}create(l){return this.productsRepo.create(this.router,l)}update(l,t){return this.productsRepo.updateTypeServices(this.router,l,t)}remove(l){return this.productsRepo.remove(this.router,l)}}return a.\u0275fac=function(l){return new(l||a)(c.LFG(d._))},a.\u0275prov=c.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},999:(N,f,n)=>{n.d(f,{Fv:()=>b,K2:()=>T,QI:()=>g,bu:()=>c});const g="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,4}$",c="^-?[0-9]+$",T="[+]?([0-9]*[.])?[0-9]+",b='(?![\\s])[a-zA-Z0-9\xe1\xe8\xe9\xed\xf3\xfa\xc1\xc8\xc9\xcd\xd3\xda\xf1\xd1\\/\\s\\.,_\\-\\\\()$\xb0\\\xdc\xfc\u201c\u201d"";:%]*'},4021:(N,f,n)=>{n.d(f,{o:()=>B});var g=n(4385),R=n(1135),c=n(2722),d=n(168),h=n(8268),a=n(4006),A=n(999),l=n(4553),t=n(1571),T=n(388),b=n(6891),E=n(6895),_=n(8796),S=n(312),Z=n(4576),I=n(7597);let O=(()=>{class s extends h.nh{constructor(o,e,r,i,u){super(),this.modalRef=o,this.fb=e,this.productsService=r,this.datePipe=i,this.currencyPipe=u,this.form=new a.cw({}),this.title="PRODUCTO",this.status="Nuevo",this.edit=!1,this.maxDate=new Date,this.currencyFormat="",this.precio=0,this.accomodations=new l.b}ngOnInit(){this.prepareForm()}prepareForm(){this.form=this.fb.group({nombre:[null,[a.kI.required,a.kI.pattern(A.Fv)]],precio:[null,[a.kI.required,a.kI.pattern(A.Fv)]],departamento:[null,[a.kI.required]],estado:["SR",[a.kI.required]]}),null!=this.products&&(this.edit=!0,this.form.controls.estado.disable(),this.form.patchValue(this.products))}confirm(){this.edit?this.update():this.create()}create(){this.loading=!0;let o={nombre:this.form.controls.nombre.getRawValue(),precio:this.form.controls.precio.getRawValue(),estado:this.form.controls.estado.getRawValue(),departamento:this.form.controls.departamento.getRawValue()};this.productsService.create(o).subscribe({next:e=>{this.handleSuccess(),this.loading=!1},error:e=>{this.loading=!1}})}handleSuccess(){this.alert("success",this.title,(this.edit?"Actualizada":"Guardada")+" Correctamente"),this.loading=!1,this.modalRef.content.callback(!0),this.modalRef.hide()}update(){if(this.products){this.loading=!0;let o={nombre:this.form.controls.nombre.getRawValue(),precio:this.form.controls.precio.getRawValue(),estado:this.form.controls.estado.getRawValue(),departamento:this.form.controls.departamento.getRawValue()};this.productsService.update(this.products.id,o).subscribe({next:e=>{this.loading=!1,this.handleSuccess()},error:e=>{this.loading=!1}})}}close(){this.modalRef.hide()}onMontoChange(o){if(o){const e=parseFloat(o.replace(/[^0-9.]/g,""));this.monto=isNaN(e)?0:e}}updateCurrency(o){const r=Number(o.target.value);console.log(r,o.data),this.form.controls.precio.setValue(this.formatToBolivianCurrency(r))}formatToBolivianCurrency(o){return this.currencyPipe.transform(o,"Bs ","symbol","1.2-2")}showHistory(o){console.log(o)}}return s.\u0275fac=function(o){return new(o||s)(t.Y36(T.UZ),t.Y36(a.qu),t.Y36(b.s),t.Y36(E.uU),t.Y36(E.H9))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-products-detail"]],features:[t.qOj],decls:48,vars:13,consts:[["header",""],[1,"modal-title"],["body",""],[1,"form-material",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md-4"],["label","Nombre",3,"control"],["type","text","formControlName","nombre",1,"form-control"],[1,"col-md-2"],["label","Precio",3,"control"],["type","text","formControlName","precio",1,"form-control",3,"change","dblclick"],[1,"col-md-3"],["label","Departamento",3,"control"],["formControlName","departamento",1,"form-control",3,"searchable","clearable"],["value","LP"],["value","OR"],["value","PT"],["value","CBBA"],["value","CH"],["value","TJA"],["value","SCZ"],["value","BE"],["value","PD"],["label","Estado",3,"control"],["formControlName","estado",1,"form-control",3,"searchable","clearable"],["value","SR"],["value","R"],["footer",""],[1,"d-flex","justify-content-center"],[1,"m-3"],[3,"type","disabled","confirm"],["type","button",1,"btn","btn-danger","active",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"app-modal")(1,"div",0)(2,"h5",1),t._uU(3),t.qZA()(),t.TgZ(4,"div",2)(5,"form",3),t.NdJ("ngSubmit",function(){return e.confirm()}),t.TgZ(6,"div",4)(7,"div",5)(8,"form-field",6),t._UZ(9,"input",7),t.qZA()(),t.TgZ(10,"div",8)(11,"form-field",9)(12,"input",10),t.NdJ("change",function(i){return e.updateCurrency(i)})("dblclick",function(i){return e.showHistory(i)}),t.qZA()()(),t.TgZ(13,"div",11)(14,"form-field",12)(15,"ng-select",13)(16,"ng-option",14),t._uU(17,"LA PAZ"),t.qZA(),t.TgZ(18,"ng-option",15),t._uU(19,"ORURO"),t.qZA(),t.TgZ(20,"ng-option",16),t._uU(21,"POTOSI"),t.qZA(),t.TgZ(22,"ng-option",17),t._uU(23,"COCHABAMBA"),t.qZA(),t.TgZ(24,"ng-option",18),t._uU(25,"CHUQUISACA"),t.qZA(),t.TgZ(26,"ng-option",19),t._uU(27,"TARIJA"),t.qZA(),t.TgZ(28,"ng-option",20),t._uU(29,"SANTA CRUZ"),t.qZA(),t.TgZ(30,"ng-option",21),t._uU(31,"BENI"),t.qZA(),t.TgZ(32,"ng-option",22),t._uU(33,"PANDO"),t.qZA()()()(),t.TgZ(34,"div",11)(35,"form-field",23)(36,"ng-select",24)(37,"ng-option",25),t._uU(38,"SIN REGISTRAR"),t.qZA(),t.TgZ(39,"ng-option",26),t._uU(40,"REGISTRADO"),t.qZA()()()()()()(),t.TgZ(41,"div",27)(42,"div",28)(43,"div",29)(44,"confirm-button",30),t.NdJ("confirm",function(){return e.confirm()}),t.qZA()(),t.TgZ(45,"div",29)(46,"button",31),t.NdJ("click",function(){return e.close()}),t._uU(47," Cancelar "),t.qZA()()()()()),2&o&&(t.xp6(3),t.AsE("",e.edit?"Editar":"Nuevo"," ",e.title,""),t.xp6(2),t.Q6J("formGroup",e.form),t.xp6(3),t.Q6J("control",e.form.get("nombre")),t.xp6(3),t.Q6J("control",e.form.get("precio")),t.xp6(3),t.Q6J("control",e.form.get("departamento")),t.xp6(1),t.Q6J("searchable",!1)("clearable",!1),t.xp6(20),t.Q6J("control",e.form.get("estado")),t.xp6(1),t.Q6J("searchable",!1)("clearable",!1),t.xp6(8),t.Q6J("type","button")("disabled",e.form.invalid))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,_.w9,_.jq,S.z,Z.h,I.f,a.sg,a.u]}),s})();const U={id:{title:"ID",sort:!1,width:"10%"},nombre:{title:"Nombre",sort:!1},precio:{title:"Precio",sort:!1},departamento:{title:"Departamento",sort:!1,type:"html",valuePrepareFunction:s=>"LP"==s?'<strong><span class="badge badge-pill badge-soft-info">LA PAZ</span></strong>':"OR"==s?'<strong><span class="badge badge-pill badge-soft-pink">ORURO</span></strong>':"PT"==s?'<strong><span class="badge badge-pill bg-info0">POTOSI</span></strong>':"CBBA"==s?'<strong><span class="badge badge-pill bg-info1">COCHABAMBA</span></strong>':"CH"==s?'<strong><span class="badge badge-pill bg-info2">CHUQUISACA</span></strong>':"TJA"==s?'<strong><span class="badge badge-pill bg-info3">TARIJA</span></strong>':"SCZ"==s?'<strong><span class="badge badge-pill bg-info4">SANTA CRUZ</span></strong>':"BE"==s?'<strong><span class="badge badge-pill bg-info5">BENI</span></strong>':"PD"==s?'<strong><span class="badge badge-pill bg-info6">PANDO</span></strong>':s,filter:{type:"list",config:{selectText:"Seleccionar",list:[{value:"LP",title:"LA PAZ"},{value:"OR",title:"ORURO"},{value:"PT",title:"POTOSI"},{value:"CBBA",title:"COCHABAMBA"},{value:"CH",title:"CHUQUISACA"},{value:"TJA",title:"TARIJA"},{value:"SCZ",title:"SANTA CRUZ"},{value:"BE",title:"BENI"},{value:"PD",title:"PANDO"}]}}},estado:{title:"Estado",sort:!1,type:"html",valuePrepareFunction:s=>"SR"==s?'<strong><span class="badge badge-pill badge-soft-pink">SIN REGISTRAR</span></strong>':"R"==s?'<strong><span class="badge badge-pill bg-disable-success">REGISTRADO</span></strong>':s,filter:{type:"list",config:{selectText:"Seleccionar",list:[{value:"SR",title:"SIN REGISTRAR"},{value:"R",title:"REGISTRADO"}]}}}};var D=n(9219),y=n(2243),L=n(4554);function M(s,m){if(1&s){const o=t.EpF();t.TgZ(0,"div",16)(1,"div",17)(2,"div",18)(3,"button",19),t.NdJ("click",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.close())}),t._uU(4," Cancelar "),t.qZA()()()()}}let B=(()=>{class s extends h.nh{constructor(o,e,r){super(),this.modalService=o,this.productsService=e,this.modalRef=r,this.data=new g.nC,this.params=new R.X(new d.NV),this.data1=[],this.columnFilters=[],this.totalItems=0,this.validButton=!1,this.settings={...this.settings,hideSubHeader:!1,actions:{columnTitle:"Acciones",edit:!0,delete:!0,add:!1,position:"right"},columns:{...U}}}ngOnInit(){this.data.onChanged().pipe((0,c.R)(this.$unSubscribe)).subscribe(o=>{"filter"===o.action&&(o.filter.filters.map(r=>{let i="",u=d.ay.ILIKE;switch(i=`filter.${r.field}`,r.field){case"id":case"precio":u=d.ay.EQ;break;default:u=d.ay.ILIKE}""!==r.search?this.columnFilters[i]=`${u}:${r.search}`:delete this.columnFilters[i]}),this.params=this.pageFilter(this.params),this.getAllShopping())}),this.params.pipe((0,c.R)(this.$unSubscribe)).subscribe(()=>this.getAllShopping())}getAllShopping(){this.loading=!0;let o={...this.params.getValue(),...this.columnFilters};this.productsService.getAll(o).subscribe({next:e=>{console.log(e),this.data.load(e.data),this.data.refresh(),this.totalItems=e.count,this.loading=!1},error:e=>{this.loading=!1,this.data.load([])}})}edit(o){this.openModal(o)}openModal(o){this.modalService.show(O,{initialState:{products:o,callback:r=>{r&&this.getAllShopping()}},class:"modal-lg modal-dialog-centered",ignoreBackdropClick:!0})}showDeleteAlert(o){this.alertQuestion("warning","Eliminar","\xbfDesea eliminar este registro?").then(e=>{e.isConfirmed&&this.delete(o.id)})}delete(o){this.productsService.remove(o).subscribe({next:()=>{this.alert("success","PRODUCTO","Borrado Correctamente"),this.params.pipe((0,c.R)(this.$unSubscribe)).subscribe(()=>this.getAllShopping())},error:e=>{this.alert("error","No se logro Eliminar","Existe una relacion")}})}close(){this.modalRef.hide()}}return s.\u0275fac=function(o){return new(o||s)(t.Y36(T.tT),t.Y36(b.s),t.Y36(T.UZ))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-products-list"]],features:[t.qOj],decls:20,vars:10,consts:[[3,"header"],["header","",1,"ch-content"],[1,"title"],["body",""],[1,"row"],[1,"col-md-8","mb-3"],[1,"col-md-4","text-end","d-flex","flex-row-reverse","mb-3"],[1,"mr-3"],["type","button","tooltip","Nuevo","containerclass","tooltip-style",1,"btn","btn-info","btn-sm","active","d-flex","justify-content-center","align-items-center","ml-3",3,"click"],[1,"bx","bx-plus","bx-sm","ml-2"],[3,"settings","leftList","settingsChange"],[1,"col-md-12"],[1,"table-responsive"],[3,"settings","source","edit","delete"],[3,"params","totalItems"],["footer","",4,"ngIf"],["footer",""],[1,"d-flex","justify-content-center"],[1,"m-3"],["type","button",1,"btn","btn-danger","active",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"app-card",0)(1,"div",1)(2,"h5",2),t._uU(3,"PRODUCTOS"),t.qZA()(),t.TgZ(4,"div",3)(5,"div",4),t._UZ(6,"div",5),t.TgZ(7,"div",6)(8,"div",7)(9,"button",8),t.NdJ("click",function(){return e.openModal()}),t._uU(10," Nuevo "),t._UZ(11,"i",9),t.qZA()(),t.TgZ(12,"app-columns-select",10),t.NdJ("settingsChange",function(i){return e.settings=i}),t.qZA()()(),t.TgZ(13,"div",4)(14,"div",11)(15,"div")(16,"div",12)(17,"ng2-smart-table",13),t.NdJ("edit",function(i){return e.edit(i.data)})("delete",function(i){return e.showDeleteAlert(i.data)}),t.qZA()(),t._UZ(18,"app-pagination",14),t.qZA()()()()(),t.YNc(19,M,5,0,"div",15)),2&o&&(t.Q6J("header",!0),t.xp6(12),t.Q6J("settings",e.settings)("leftList",!0),t.xp6(3),t.Tol(e.loading?"table-loading":""),t.xp6(2),t.Q6J("settings",e.settings)("source",e.data),t.xp6(1),t.Q6J("params",e.params)("totalItems",e.totalItems),t.xp6(1),t.Q6J("ngIf",e.validButton))},dependencies:[E.O5,D.A,y.L,g.T5,L.Q]}),s})()}}]);